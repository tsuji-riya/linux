--- net/netfilter/xt_DSCP.c	2009-12-03 11:51:21.000000000 +0800
+++ net/netfilter/xt_DSCP.c	2011-08-22 20:21:21.047332000 +0800
@@ -99,7 +99,7 @@
 	u_int8_t orig, nv;
 
 	orig = ipv6_get_dsfield(iph);
-	nv   = (orig & info->tos_mask) ^ info->tos_value;
+	nv   = (orig & ~info->tos_mask) ^ info->tos_value;
 
 	if (orig != nv) {
 		if (!skb_make_writable(skb, sizeof(struct iphdr)))
